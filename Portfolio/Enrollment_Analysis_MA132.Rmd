---
title: "Math Department Data Analysis"
author: "Cameron Mitchell"
date: "23 Sep 2020"
output: html_notebook
---

The intention of this anaylsis is to try to predict how many students will be in MA132 (Calculus II) in the upcoming year.


Loading packages
```{r}
library(tidyverse)
library(janitor)
library(readxl)
library(skimr)
library(summarytools)
```

Reading the data from an excel file that is stored in the data folder.

```{r}
dfa = read_excel("../Data/CU_ACAD_DEPT_ENRL.xls") %>%
clean_names()
```

Quick summary of the data available

```{r}
skim(dfa)
```

Tidying the data

```{r}
dfb = dfa %>%
  separate(col = term2, into = c("semester","year"), sep = " ")
```

Cleaning and organizing the data that is required to complete this analysis

dfc1 will contain the data for calculus 1 and dfc2 will contain the data from calculus 2.

```{r}
# dfc1 = dfb %>%
#   select(-c(section, term, acad_org,current_status,instructor,course_id)) %>%
#   filter(title == "Calculus I", component == "LEC", year < 2021) %>%
#   unique()

dfc2 = dfb %>%
  select(-c(section, term, acad_org,current_status,instructor,course_id)) %>%
  filter(title == "Calculus II", component == "LEC", year < 2021) %>%
  unique() %>%
  group_by(title, semester, year)
summarise(dfc2, tot_enrl = sum(tot_enrl))
```

Visualizing the data to see what factors might contribute to the classes enrollment

```{r}
dfc2 %>%
  ggplot(aes(x = year, y = tot_enrl)) + geom_point()
```

